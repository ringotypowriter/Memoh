experimental_monorepo_root = true

[tools]
# Go version from go.mod
go = "1.25.2"
# Node.js for frontend packages
node = "22"
# Bun for agent gateway
bun = "latest"
# pnpm for workspace management
pnpm = "9"

[task_config]
dir = "{{cwd}}"

[settings]
experimental = true

[tasks.pnpm-install]
description = "Install dependencies"
run = "pnpm install"

[tasks.go-install]
description = "Install Go dependencies"
run = "go mod download"

[tasks.swagger-generate]
description = "Generate Swagger documentation"
run = "cd internal/handlers && go generate"

[tasks.sqlc-generate]
description = "Generate SQL code"
run = "sqlc generate"

[tasks.db-up]
description = "Intialize and Migrate Database"
run = "scripts/db-up.sh"

[tasks.db-down]
description = "Drop Database"
run = "scripts/db-down.sh"

[tasks.dev]
description = "Start development environment"
depends = [
  "//:swagger-generate",
  "//:sqlc-generate",
  "//agent:dev",
  "//cmd/agent:start",
  "//packages/web:dev",
]

[tasks.setup]
description = "Setup development environment"
depends = [
  "//:db-up",
  "//:pnpm-install",
  "//:go-install",
]
run = "echo 'âœ“ Setup complete! Next: Copy config.toml.example to config.toml and configure, then run: mise run dev:web'"

